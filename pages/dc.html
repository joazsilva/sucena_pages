<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário DC</title>

    <link rel="stylesheet" href="/styles/style-dc.css">
</head>
<body>
    <header>
        <h1> Formulário DC</h1>

         <a href="/index.html" class="back-link">
            <img src="/assets/seta-esquerda.png" alt="seta-esquerda">
            Página Inicial
        </a>
    </header>
    <form action="https://docs.google.com/forms/d/e/1FAIpQLSf-u7JzKMF8ui9vV5e8Cq0SFUikGhyK7Drq2sSZiDGJk7g66g/formResponse" method="post" id="meuForm">
        <section class="data-section">
            <h2>Dados de Data</h2>

            <label for="data">Data:</label>
            <input type="date" name="entry.889087282" id="data" required>

            <label for="obra">Obra:</label>
            <input type="text" name="entry.93155820" id="obra" required>

            <label for="localidade">Localidade:</label>
            <input type="text" name="entry.1083742524" id="localidade" required>

            <label for="time">Hora:</label>
            <input type="time" name="entry.914062850" id="time" required>

        </section>

        <section class="observador-section">
            <h2>Dados do Observador</h2>

            <label for="observador">Nome Completo:</label>
            <input type="text" name="entry.1161670705" id="observador" required>
    
            <label for="cpf">Matrícula/CPF:</label>
            <input type="text" name="entry.1544034142" id="cpf" required>
            
            <label for="empresa">Empresa:</label>
            <input type="text" name="entry.631376482" id="empresa" required>

        </section>

        <section class="observacoes-section">
            <h2>Observações</h2>

            <label for="tipo-diagnostico">Tipo de Diagnóstico Comportamental:</label>
            <select name="entry.650562550" id="tipo-diagnostico" required>
                <option value="Selecione aqui">Selecione aqui</option>
                <option value="Programado">Programado</option>
                <option value="De oportunidade">De oportunidade</option>
            </select>

            <label for="empresa-observacoes">Empresa:</label>
            <input type="text" name="entry.1653444875" id="empresa-observacoes" required>

            <label for="num-empregados">Número de empregados observados:</label>
            <input type="number" name="entry.287513704" id="num-empregados" required>

            <label for="observacoes">Observações:</label>
            <textarea name="entry.1943337357" id="observacoes"></textarea>
        </section>

    <section class="evaluation">
      <h2>Tipo DC:</h2>
      <div class="radio-group">
        <label><input type="radio" name="entry.361265301" value="Positivo" required> Positivo</label>
        <label><input type="radio" name="entry.361265301" value="Negativo" required> Negativo</label>
      </div>
    </section>

    <section class="category">
      <h2>Equipamentos de Proteção Individual (EPI)</h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>S</th>
            <th>NS</th>
            <th>PPA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Cabeça.</td>
            <td><input type="radio" name="entry.2136619294" value="S"></td>
            <td><input type="radio" name="entry.2136619294" value="NS"></td>
            <td><input type="radio" name="entry.2136619294" value="PPA"></td>
          </tr>
          <tr>
            <td>Olhos.</td>
            <td><input type="radio" name="entry.616327635" value="S"></td>
            <td><input type="radio" name="entry.616327635" value="NS"></td>
            <td><input type="radio" name="entry.616327635" value="PPA"></td>
          </tr>
          <tr>
            <td>Boca Nariz (Sistema Respiratório).</td>
            <td><input type="radio" name="entry.334141301" value="S"></td>
            <td><input type="radio" name="entry.334141301" value="NS"></td>
            <td><input type="radio" name="entry.334141301" value="PPA"></td>
          </tr>
          <tr>
            <td>Mãos e braços.</td>
            <td><input type="radio" name="entry.1437904700" value="S"></td>
            <td><input type="radio" name="entry.1437904700" value="NS"></td>
            <td><input type="radio" name="entry.1437904700" value="PPA"></td>
          </tr>
          <tr>
            <td>Pés e Pernas.</td>
            <td><input type="radio" name="entry.1523095588" value="S"></td>
            <td><input type="radio" name="entry.1523095588" value="NS"></td>
            <td><input type="radio" name="entry.1523095588" value="PPA"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="category">
      <h2>Agentes de Risco</h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>S</th>
            <th>NS</th>
            <th>PPA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Poeira, gases e vapores.</td>
            <td><input type="radio" name="entry.1785053184" value="S"></td>
            <td><input type="radio" name="entry.1785053184" value="NS"></td>
            <td><input type="radio" name="entry.1785053184" value="PPA"></td>
          </tr>
          <tr>
            <td>Ruído e vibração.</td>
            <td><input type="radio" name="entry.1961932904" value="S"></td>
            <td><input type="radio" name="entry.1961932904" value="NS"></td>
            <td><input type="radio" name="entry.1961932904" value="PPA"></td>
          </tr>
          <tr>
            <td>Temperatura.</td>
            <td><input type="radio" name="entry.1314490865" value="S"></td>
            <td><input type="radio" name="entry.1314490865" value="NS"></td>
            <td><input type="radio" name="entry.1314490865" value="PPA"></td>
          </tr>
          <tr>
            <td>Iluminação.</td>
            <td><input type="radio" name="entry.248698236" value="S"></td>
            <td><input type="radio" name="entry.248698236" value="NS"></td>
            <td><input type="radio" name="entry.248698236" value="PPA"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="category">
      <h2>Ergonomia</h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>S</th>
            <th>NS</th>
            <th>PPA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Postura Adequada</td>
            <td><input type="radio" name="entry.837405604" value="S"></td>
            <td><input type="radio" name="entry.837405604" value="NS"></td>
            <td><input type="radio" name="entry.837405604" value="PPA"></td>
          </tr>
          <tr>
            <td>Movimentos críticos</td>
            <td><input type="radio" name="entry.1508814259" value="S"></td>
            <td><input type="radio" name="entry.1508814259" value="NS"></td>
            <td><input type="radio" name="entry.1508814259" value="PPA"></td>
          </tr>
          <tr>
            <td>Cansaço / fadiga</td>
            <td><input type="radio" name="entry.953369144" value="S"></td>
            <td><input type="radio" name="entry.953369144" value="NS"></td>
            <td><input type="radio" name="entry.953369144" value="PPA"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="category">
      <h2>Ambiente</h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>S</th>
            <th>NS</th>
            <th>PPA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Local em ordem e limpo</td>
            <td><input type="radio" name="entry.1167913249" value="S"></td>
            <td><input type="radio" name="entry.1167913249" value="NS"></td>
            <td><input type="radio" name="entry.1167913249" value="PPA"></td>
          </tr>
          <tr>
            <td>Possibilidade de deslocamento conforme sinalização/ lei</td>
            <td><input type="radio" name="entry.717381040" value="S"></td>
            <td><input type="radio" name="entry.717381040" value="NS"></td>
            <td><input type="radio" name="entry.717381040" value="PPA"></td>
          </tr>
          <tr>
            <td>Bloqueio e sinalização adequados</td>
            <td><input type="radio" name="entry.632479179" value="S"></td>
            <td><input type="radio" name="entry.632479179" value="NS"></td>
            <td><input type="radio" name="entry.632479179" value="PPA"></td>
          </tr>
          <tr>
            <td>Isolamento da área</td>
            <td><input type="radio" name="entry.1035506472" value="S"></td>
            <td><input type="radio" name="entry.1035506472" value="NS"></td>
            <td><input type="radio" name="entry.1035506472" value="PPA"></td>
          </tr>
          <tr>
            <td>Risco de queda</td>
            <td><input type="radio" name="entry.443872312" value="S"></td>
            <td><input type="radio" name="entry.443872312" value="NS"></td>
            <td><input type="radio" name="entry.443872312" value="PPA"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="category">
      <h2>Ferramentas, Máquinas e Equipamentos</h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>S</th>
            <th>NS</th>
            <th>PPA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Adequados ao serviço</td>
            <td><input type="radio" name="entry.767565495" value="S"></td>
            <td><input type="radio" name="entry.767565495" value="NS"></td>
            <td><input type="radio" name="entry.767565495" value="PPA"></td>
          </tr>
          <tr>
            <td>Em boas condições</td>
            <td><input type="radio" name="entry.1766692589" value="S"></td>
            <td><input type="radio" name="entry.1766692589" value="NS"></td>
            <td><input type="radio" name="entry.1766692589" value="PPA"></td>
          </tr>
          <tr>
            <td>Utilização correta(sem improvisação)</td>
            <td><input type="radio" name="entry.1278709579" value="S"></td>
            <td><input type="radio" name="entry.1278709579" value="NS"></td>
            <td><input type="radio" name="entry.1278709579" value="PPA"></td>
          </tr>
          <tr>
            <td>Dispositivos de segurança</td>
            <td><input type="radio" name="entry.723746000" value="S"></td>
            <td><input type="radio" name="entry.723746000" value="NS"></td>
            <td><input type="radio" name="entry.723746000" value="PPA"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="category">
      <h2>Procedimentos, Regras e Instruções</h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>S</th>
            <th>NS</th>
            <th>PPA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Existente</td>
            <td><input type="radio" name="entry.591903019" value="S"></td>
            <td><input type="radio" name="entry.591903019" value="NS"></td>
            <td><input type="radio" name="entry.591903019" value="PPA"></td>
          </tr>
          <tr>
            <td>Conhecidos e Compreendidos</td>
            <td><input type="radio" name="entry.833008782" value="S"></td>
            <td><input type="radio" name="entry.833008782" value="NS"></td>
            <td><input type="radio" name="entry.833008782" value="PPA"></td>
          </tr>
          <tr>
            <td>Cumprido</td>
            <td><input type="radio" name="entry.838417584" value="S"></td>
            <td><input type="radio" name="entry.838417584" value="NS"></td>
            <td><input type="radio" name="entry.838417584" value="PPA"></td>
          </tr>
          <tr>
            <td>ART realizada</td>
            <td><input type="radio" name="entry.464857443" value="S"></td>
            <td><input type="radio" name="entry.464857443" value="NS"></td>
            <td><input type="radio" name="entry.464857443" value="PPA"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="evaluation">
      <h2>Avaliação Geral: Percepção de Risco</h2>
      <div class="radio-group">
        <label><input type="radio" name="entry.859718888" value="Ruim"> Ruim</label>
        <label><input type="radio" name="entry.859718888" value="Média"> Média</label>
        <label><input type="radio" name="entry.859718888" value="Ótima"> Ótima</label>
      </div>
    </section>

    <section class="evaluation">
      <h2>Atitude Segura:</h2>
      <div class="radio-group">
        <label><input type="radio" name="entry.535270387" value="Ruim"> Ruim</label>
        <label><input type="radio" name="entry.535270387" value="Média"> Média</label>
        <label><input type="radio" name="entry.535270387" value="Ótima"> Ótima</label>
      </div>
    </section>

    <section class="evaluation">
      <h2>Compromisso assumido:</h2>
      <textarea name="entry.2116056758" rows="4" id = 'compromissoAssumido'></textarea>
    </section>

    <button type="submit">Enviar</button>


    </form>

    <script>
  

    document.getElementById('meuForm').addEventListener('submit', function (event) {
   
      console.log("tentando salvar")
      event.preventDefault();

      // Obtém os valores dos campos do formulário HTML
  var obraValue = document.getElementById('obra').value || " ";
  var dataValue = document.getElementById('data').value || " ";
  var horaValue = document.getElementById('hora').value || " ";
  var localidadeValue = document.getElementById('localidade').value || " ";
  var nomeValue = document.getElementById('nome').value;
  var matriculaValue = document.getElementById('matricula').value || " ";
  var empresaObservadorValue = document.getElementById('empresa-observador').value  || " ";
  var tipoDiagnosticoValue = document.getElementById('tipo-diagnostico').value  || " ";
  var empresaObservacoesValue = document.getElementById('empresa-observacoes').value || " ";
  var numEmpregadosValue = document.getElementById('num-empregados').value || " ";
  var observacoesValue = document.getElementById('observacoes').value || " ";

  // Campo de opção: Tipo DC
  var tipoDcElement = document.querySelector('input[name="entry.361265301"]:checked');
  var tipoDcValue = tipoDcElement ? tipoDcElement.value : " ";

  // Campo de opção: EPI Cabeça
  var cabecaElement = document.querySelector('input[name="entry.2136619294"]:checked');
  var cabecaValue = cabecaElement ? cabecaElement.value : " ";

  // Campo de opção: EPI Olhos
  var olhosElement = document.querySelector('input[name="entry.616327635"]:checked');
  var olhosValue = olhosElement ? olhosElement.value : " ";

  // Campo de opção: EPI Respiratório
  var respiratorioElement = document.querySelector('input[name="entry.334141301"]:checked');
  var respiratorioValue = respiratorioElement ? respiratorioElement.value : " ";

  // Campo de opção: EPI Mãos e Braços
  var maosElement = document.querySelector('input[name="entry.1437904700"]:checked');
  var maosValue = maosElement ? maosElement.value : " ";

  // Campo de opção: EPI Pés e Pernas
  var pesElement = document.querySelector('input[name="entry.1523095588"]:checked');
  var pesValue = pesElement ? pesElement.value : " ";

  // Campo de opção: Poeira, Gases e Vapores
  var poeiraElement = document.querySelector('input[name="entry.1785053184"]:checked');
  var poeiraValue = poeiraElement ? poeiraElement.value : " ";

  // Campo de opção: Ruído e Vibração
  var ruidoElement = document.querySelector('input[name="entry.1961932904"]:checked');
  var ruidoValue = ruidoElement ? ruidoElement.value : " ";

  // Campo de opção: Temperatura
  var temperaturaElement = document.querySelector('input[name="entry.1314490865"]:checked');
  var temperaturaValue = temperaturaElement ? temperaturaElement.value : " ";

  // Campo de opção: Iluminação
  var iluminacaoElement = document.querySelector('input[name="entry.248698236"]:checked');
  var iluminacaoValue = iluminacaoElement ? iluminacaoElement.value : " ";

  // Campo de opção: Postura Adequada
  var posturaElement = document.querySelector('input[name="entry.837405604"]:checked');
  var posturaValue = posturaElement ? posturaElement.value : " ";

  // Campo de opção: Movimentos Críticos
  var movimentosElement = document.querySelector('input[name="entry.1508814259"]:checked');
  var movimentosValue = movimentosElement ? movimentosElement.value : " ";

  // Campo de opção: Cansaço / Fadiga
  var cansacoElement = document.querySelector('input[name="entry.953369144"]:checked');
  var cansacoValue = cansacoElement ? cansacoElement.value : " ";

  // Campo de opção: Local em Ordem e Limpo
  var localOrdemElement = document.querySelector('input[name="entry.1167913249"]:checked');
  var localOrdemValue = localOrdemElement ? localOrdemElement.value : " ";

  // Campo de opção: Possibilidade de Deslocamento
  var possibilidadeDeslocamentoElement = document.querySelector('input[name="entry.717381040"]:checked');
  var possibilidadeDeslocamentoValue = possibilidadeDeslocamentoElement ? possibilidadeDeslocamentoElement.value : " ";

  // Campo de opção: Bloqueio e Sinalização Adequados
  var bloqueioSinalizacaoElement = document.querySelector('input[name="entry.632479179"]:checked');
  var bloqueioSinalizacaoValue = bloqueioSinalizacaoElement ? bloqueioSinalizacaoElement.value : " ";

  // Campo de opção: Isolamento da Área
  var isolamentoElement = document.querySelector('input[name="entry.1035506472"]:checked');
  var isolamentoValue = isolamentoElement ? isolamentoElement.value : " ";

  // Campo de opção: Risco de Queda
  var riscoQuedaElement = document.querySelector('input[name="entry.443872312"]:checked');
  var riscoQuedaValue = riscoQuedaElement ? riscoQuedaElement.value : " ";

  // Campo de opção: Adequados ao Serviço
  var protecaoPartesMoveisElement = document.querySelector('input[name="entry.767565495"]:checked');
  var protecaoPartesMoveisValue = protecaoPartesMoveisElement ? protecaoPartesMoveisElement.value : " ";

  // Campo de opção: Em Boas Condições
  var boasCondicoesElement = document.querySelector('input[name="entry.1766692589"]:checked');
  var boasCondicoesValue = boasCondicoesElement ? boasCondicoesElement.value : " ";

  // Campo de opção: Utilização Correta (sem improvisação)
  var utilizacaoCorretaElement = document.querySelector('input[name="entry.1278709579"]:checked');
  var utilizacaoCorretaValue = utilizacaoCorretaElement ? utilizacaoCorretaElement.value : " ";

  // Campo de opção: Dispositivos de Segurança
  var dispositivosDeSegurancaElement = document.querySelector('input[name="entry.723746000"]:checked');
  var dispositivosDeSegurancaValue = dispositivosDeSegurancaElement ? dispositivosDeSegurancaElement.value : " ";

  // Campo de opção: Existente
  var existenteElement = document.querySelector('input[name="entry.591903019"]:checked');
  var existenteValue = existenteElement ? existenteElement.value : " ";

  // Campo de opção: Conhecidos e Compreendidos
  var conhecidosElement = document.querySelector('input[name="entry.833008782"]:checked');
  var conhecidosValue = conhecidosElement ? conhecidosElement.value : " ";

  // Campo de opção: Cumprido
  var cumpridoElement = document.querySelector('input[name="entry.838417584"]:checked');
  var cumpridoValue = cumpridoElement ? cumpridoElement.value : " ";

  // Campo de opção: ART Realizada
  var artElement = document.querySelector('input[name="entry.464857443"]:checked');
  var artValue = artElement ? artElement.value : " ";

  // Campo de opção: Percepção de Risco
  var percepcaoRiscoElement = document.querySelector('input[name="entry.859718888"]:checked');
  var percepcaoRiscoValue = percepcaoRiscoElement ? percepcaoRiscoElement.value : " ";

  // Campo de opção: Atitude Segura
  var atitudeSeguraElement = document.querySelector('input[name="entry.535270387"]:checked');
  var atitudeSeguraValue = atitudeSeguraElement ? atitudeSeguraElement.value : " ";

  var compromissoAssumidoValue = document.getElementById('compromissoAssumido').value || " ";

  console.log(dataValue);
  console.log(empresaObservacoesValue);


      var formData = new FormData();
      formData.append('entry.889087282', dataValue);
      formData.append('entry.93155820', obraValue);
      formData.append('entry.1083742524', localidadeValue);
      formData.append('entry.914062850', horaValue);
      formData.append('entry.1161670705', nomeValue);
      formData.append('entry.1544034142', matriculaValue);
      formData.append('entry.650562550', tipoDiagnosticoValue);
      formData.append('entry.631376482', empresaObservadorValue);
      formData.append('entry.1653444875', empresaObservacoesValue);
      formData.append('entry.287513704', numEmpregadosValue);
      formData.append('entry.1943337357', observacoesValue);
      formData.append('entry.361265301', tipoDcValue);
      formData.append('entry.2136619294', cabecaValue);
      formData.append('entry.616327635', olhosValue);
      formData.append('entry.334141301', respiratorioValue);
      formData.append('entry.1437904700', maosValue);
      formData.append('entry.1523095588', pesValue);
      formData.append('entry.1785053184', poeiraValue);
      formData.append('entry.1961932904', ruidoValue);
      formData.append('entry.1314490865', temperaturaValue);
      formData.append('entry.248698236', iluminacaoValue);
      formData.append('entry.837405604', posturaValue);
      formData.append('entry.1508814259', movimentosValue);
      formData.append('entry.953369144', cansacoValue);
      formData.append('entry.1167913249', localOrdemValue);
      formData.append('entry.717381040', possibilidadeDeslocamentoValue);
      formData.append('entry.632479179', bloqueioSinalizacaoValue);
      formData.append('entry.1035506472', isolamentoValue);
      formData.append('entry.443872312', riscoQuedaValue);
      formData.append('entry.767565495', protecaoPartesMoveisValue);
      formData.append('entry.1766692589', boasCondicoesValue);
      formData.append('entry.1278709579', utilizacaoCorretaValue);
      formData.append('entry.723746000', dispositivosDeSegurancaValue);
      formData.append('entry.591903019', existenteValue);
      formData.append('entry.833008782', conhecidosValue);
      formData.append('entry.838417584', cumpridoValue);
      formData.append('entry.464857443', artValue);
      formData.append('entry.859718888', percepcaoRiscoValue);
      formData.append('entry.535270387', atitudeSeguraValue);
      formData.append('entry.2116056758', compromissoAssumidoValue);

      var xhr = new XMLHttpRequest();
      xhr.open('POST', 'https://docs.google.com/forms/d/e/1FAIpQLSf-u7JzKMF8ui9vV5e8Cq0SFUikGhyK7Drq2sSZiDGJk7g66g/formResponse');
      xhr.onreadystatechange = function () {
        // Verifica se a solicitação foi concluída e bem-sucedida (readyState 4 e status 200)
        if (xhr.readyState === 4) {
          // Exibe o alerta de confirmação após o envio dos dados
          alert('Dados enviados com sucesso!');

          // Reseta o formulário simulado após o envio
          document.getElementById('meuForm').reset();
          var confirmDownload = confirm("Comprovante gerado com sucesso! Deseja fazer o download da imagem?");
          if (confirmDownload) {
            // Gera a imagem personalizada com os dados do formulário e faz o download
            generateImage();

function generateImage() {

  var canvas = document.createElement('canvas');
  canvas.width = 450;
  canvas.height = 450;
  var ctx = canvas.getContext('2d');

  ctx.fillStyle = '#FFFFFF';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  var img = new Image();
  img.src = "../img/logo_nova.png";
  img.onload = function () {
    ctx.drawImage(img, 20, 20, 350, 150);

    ctx.fillStyle = '#000000';
    ctx.font = '16px Arial';

    var lineHeight = 30;
    var y = 200;

    ctx.fillText('Novo DC Adicionado ✅', 20, y);
    y += lineHeight;
    y += lineHeight;
    ctx.fillText('Obra: ' + (obraValue), 20, y);
    y += lineHeight;
    ctx.fillText('Data: ' + (dataValue), 20, y);
    y += lineHeight;
    ctx.fillText('Hora: ' + (horaValue), 20, y);
    y += lineHeight;
    ctx.fillText('Nome: ' + (nomeValue), 20, y);
    y += lineHeight;
    ctx.fillText('Localidade: ' + (localidadeValue), 20, y);
    y += lineHeight;
    ctx.fillText('Tipo de Diagnóstico: ' + (tipoDiagnosticoValue), 20, y);
    y += lineHeight;
    ctx.fillText('Empresa avaliada: ' + (empresaObservacoesValue), 20, y);
    y += lineHeight;
    ctx.fillText('Empresa avaliadora: ' + (empresaObservadorValue), 20, y);

    var link = document.createElement('a');
    link.download = 'novo_dc_adicionado.jpg';
    link.href = canvas.toDataURL('image/jpg');
    link.click();
  };
}

           
          }
        }
      };
      xhr.send(formData);
    });
  </script>
</body>
</html>